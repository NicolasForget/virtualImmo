<!DOCTYPE HTML>
<html>
  <head>
    <link rel="stylesheet" type="text/css" href="style.css" />
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
    <script type="text/javascript" src="js/menu.js"></script>
    <!-- <script type="text/javascript" src="js/sample.js"></script> -->
    


  </head>
  <body>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="#">Project name</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li class="active"><a href="#">Home</a></li>
            <li><a href="#help">Help</a></li>
            <li><a href="#contact">Contact</a></li>
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Dropdown <span class="caret"></span></a>
              <ul class="dropdown-menu">
                <li><a href="#">Action</a></li>
                <li><a href="#">Another action</a></li>
                <li><a href="#">Something else here</a></li>
                <li role="separator" class="divider"></li>
                <li class="dropdown-header">Nav header</li>
                <li><a href="#">Separated link</a></li>
                <li><a href="#">One more separated link</a></li>
              </ul>
            </li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">
        <div class="col-12" id="main-content">
           <canvas id="map"></canvas>
           <canvas id="canvas"></canvas>
           <!-- <div id='piemenu' data-wheelnav
           data-wheelnav-slicepath='DonutSlice'
           data-wheelnav-marker data-wheelnav-markerpath='DropMarker'
           data-wheelnav-navangle='180'
           data-wheelnav-titleheight='45'
           data-wheelnav-cssmode 
           data-wheelnav-init>
            <div data-wheelnav-navitemicon='check' onmouseup=''></div>
            <div data-wheelnav-navitemimg='http://pmg.softwaretailoring.net/img/pmg_favicon.png' onmouseup=''></div>
            <div data-wheelnav-navitemicon='checkbox' onmouseup=''></div>
            <div data-wheelnav-navitemicon='checked' onmouseup=''></div>
            <div data-wheelnav-navitemicon='star' onmouseup=''></div>
          </div> -->
        </div>
      </div>
    </div>

    <div id="piemenu">
      <svg width="400" height="400">
        <g id="menu-holder" transform="translate(200,200)"></g>
      </svg>
    </div>



    <footer class="footer">
      <div class="container">
        <p class="text-muted">Place sticky footer content here.</p>
      </div>
    </footer>
        <script>
          $(document).ready(function(){
            $("#canvas").outerHeight($(window).height()-$("#canvas").offset().top-Math.abs( $("#canvas").outerHeight(true) - $("#canvas").outerHeight()));
            $("#h-input").val($("#canvas").outerHeight());
            $("#w-input").val($("#canvas").outerWidth());
            $("#set-size").click(function(){
              $("#canvas").outerHeight($("#h-input").val());
              $("#main-content").width($("#w-input").val());
              $("#canvas").outerWidth($("#main-content").width());
            });

            $("#map").outerHeight($(window).height()-$("#map").offset().top-Math.abs( $("#map").outerHeight(true) - $("#map").outerHeight()));
            $("#h-input").val($("#map").outerHeight());
            $("#w-input").val($("#map").outerWidth());
            $("#set-size").click(function(){
              $("#map").outerHeight($("#h-input").val());
              $("#main-content").width($("#w-input").val());
              $("#map").outerWidth($("#main-content").width());
            });
          });

          var canvas = document.getElementById("canvas");
          var map = document.getElementById("map");
          // $(window).resize(function(){
          //   var ctx = canvas.getContext('2d');
          //   console.log($(window).height() - 126);
          //   console.log($(window).width() - 6);
          //   ctx.canvas.height = $(window).height() - 126;
          //   ctx.canvas.width = $(window).width() - 6;
          // });

          var sofas = [
            { icon : "img/1.png", action: "console.log('1');if(m)m.hide();changeLayer(false);" },
            { icon : "img/2.png", action: "console.log('2');if(m)m.hide();changeLayer(false);" },
            { icon : "img/4.png", action: "console.log('3');if(m)m.hide();changeLayer(false);" },
            { icon : "img/9.png", action: "console.log('4');if(m)m.hide();changeLayer(false);" },
            { icon : "img/8.png", action: "console.log('5');if(m)m.hide();changeLayer(false);" }  
          ];

          // var m = new d3.radialMenu().radius(40).thickness(100)
          //               .appendTo("#menu-holder");

          // Show menu launch
          var m;
          


          var windowH = $(window).height() - 130;
          var windowW = $(window).width();
          canvas.width = windowW;
          canvas.height = windowH;
          map.width = windowW;
          map.height = windowH;
          

          canvas.addEventListener('click', function(event) {
            var x = event.pageX - canvas.offsetLeft;
                y = event.pageY - canvas.offsetTop;
            console.log(x, y);
            // createSquare(canvas, x, y, 20, 20);
            createMenu(event.pageX,event.pageY);
          }, false);

          


          function createSquare(canvas, x, y, height, width){
            var ctx = canvas.getContext('2d');
            ctx.fillRect(x, y, height, width);
          }

          function createMenu(x,y){
            changeLayer(true);
            if(m){
              m.hide();
            }
            
            d3.select("#menu-holder").selectAll("g").each(function(){
              d3.select(this).remove();
            });
            
            m = new d3.radialMenu().radius(50).thickness(150).iconSize(120)
                        .appendTo("#menu-holder").show(sofas);

            var menu = $("#piemenu");
            menu.css('position', 'absolute');
            menu.css("left", x - 200);
            menu.css("top", y - 200);
          }

          function drawMap(){

          }

          function changeLayer(flag){
            if(flag){
              d3.select("#piemenu").attr("class","piemenufirstLayer");
            }else{
              d3.select("#piemenu").attr("class","piemenuLastLayer");
            }
          }

        </script>
  </body>
</html>

